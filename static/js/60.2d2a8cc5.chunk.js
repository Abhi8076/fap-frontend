"use strict";(self.webpackChunkorder_frontend=self.webpackChunkorder_frontend||[]).push([[60],{5060:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var l=a(5043),n=a(2019),o=a(9444),r=a(3530),s=a(4434),i=a(3072),d=a(2148),c=a(6825),u=a(7261),p=a(579);const m=e=>{const{title:t,onBack:a,rightContent:l}=e;return(0,p.jsxs)(u.st,{w:"100%",h:"56px",m:"0",p:"10px 20px",bg:"#EDF6FF",children:[(0,p.jsxs)(u.st,{m:"auto 0",gap:"10px",children:[(0,p.jsx)(c.Z,{size:24,color:"#000",onClick:a}),(0,p.jsx)(u.D7,{fs:"18px",lh:"24px",fw:"600",ff:"Inter",c:"#000",mb:"auto",children:t})]}),l]})},h={PENDING:"processing",SENT:"success",CANCELLED:"warning"};var x=a(5672),y=a(9748),g=a(6603),v=a(6051),b=a(5720),f=a(3188),j=a(4923),C=a(6177),A=a(446),w=a.n(A);const I=w()().valueOf(),S=e=>{const{open:t,onClose:a,allContacts:o,allItems:i,allAgents:c,fetchOrders:u}=e,[m,h]=(0,l.useState)(!1);return(0,p.jsx)(x.A,{title:"Add Sales",footer:null,loading:m,open:t,onCancel:a,styles:{content:{padding:"10px"}},style:{top:"50px"},children:(0,p.jsxs)(y.A,{labelCol:{xs:{span:10},sm:{span:8}},wrapperCol:{xs:{span:14},sm:{span:16}},initialValues:{saleType:"local",date:I},layout:"horizontal",size:"middle",style:{maxWidth:600,margin:"20px 0 10px"},onFinish:async e=>{var t;h(!0);const l={saleOrder:{contactId:e.contactId,agentId:e.agentId,saleType:e.saleType},lineItems:null===(t=e.lineItems)||void 0===t?void 0:t.map((e=>({itemId:e.itemId,type:"SALE_ORDER",quantity:e.quantity,unit:e.unit,rate:e.rate,itemTotal:e.quantity*e.rate}))),containers:e.containers};try{await(e=>{const t=`${d.H$}/saleOrder/add-sale-order`;return(0,d.Em)({url:t,method:"post",data:e,headers:{"Content-Type":"application/json"}})})(l),n.Ay.success("sale order added successfully"),u(),a()}catch(o){(0,d.ok)(o)}finally{h(!1)}},children:[(0,p.jsx)(y.A.Item,{name:"date",wrapperCol:{span:24},style:{textAlign:"right"},rules:[{required:!0}],getValueProps:e=>({value:e&&w()(Number(e))}),normalize:e=>e&&`${w()(e).valueOf()}`,children:(0,p.jsx)(r.A,{})}),(0,p.jsx)(y.A.Item,{name:"contactId",wrapperCol:{span:24},rules:[{required:!0,message:"Please select a customer!"}],children:(0,p.jsx)(s.A,{showSearch:!0,placeholder:"Select Customer",optionFilterProp:"label",filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:o})}),(0,p.jsx)(y.A.Item,{name:"saleType",label:"sale type",rules:[{required:!0,message:"Please pick an item!"}],children:(0,p.jsxs)(g.Ay.Group,{children:[(0,p.jsx)(g.Ay.Button,{value:"local",children:"Local"}),(0,p.jsx)(g.Ay.Button,{value:"interState",children:"InterState"})]})}),(0,p.jsx)(y.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.saleType!==t.saleType,children:e=>{let{getFieldValue:t}=e;return"interState"===t("saleType")?(0,p.jsx)(y.A.Item,{name:"agentId",label:"Agent",children:(0,p.jsx)(s.A,{showSearch:!0,placeholder:"Select Agent",optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:c})}):null}}),(0,p.jsx)(y.A.List,{name:"lineItems",rules:[{validator:async(e,t)=>{if(!t||t.length<1)return Promise.reject(new Error("At least 1 Item"))}}],children:(e,t,a)=>{let{add:l,remove:n}=t,{errors:o}=a;return(0,p.jsxs)(p.Fragment,{children:[e.map((e=>{let{key:t,name:a,...l}=e;return(0,p.jsxs)(v.A,{style:{display:"flex"},align:"baseline",children:[(0,p.jsx)(y.A.Item,{...l,name:[a,"itemId"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing item"}],children:(0,p.jsx)(s.A,{showSearch:!0,placeholder:"items",optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:i,style:{width:"100%"}})}),(0,p.jsx)(y.A.Item,{...l,name:[a,"rate"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing rate"}],children:(0,p.jsx)(b.A,{placeholder:"Rate",type:"number",style:{marginBottom:0}})}),(0,p.jsx)(y.A.Item,{...l,name:[a,"quantity"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing quantity"}],children:(0,p.jsx)(b.A,{placeholder:"Qtn",type:"number",style:{marginBottom:0}})}),(0,p.jsx)(y.A.Item,{...l,name:[a,"unit"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing unit"}],children:(0,p.jsx)(s.A,{placeholder:"units",style:{width:"100%"},children:d.J8.map((e=>(0,p.jsx)(s.A.Option,{value:e,children:e},e)))})}),(0,p.jsx)(j.F,{size:24,color:"#000",style:{marginBottom:"-7px"},onClick:()=>n(a)})]},t)})),(0,p.jsxs)(y.A.Item,{wrapperCol:{span:24},children:[(0,p.jsx)(f.Ay,{type:"dashed",onClick:()=>l(),block:!0,icon:(0,p.jsx)(C.f,{size:24,color:"#000"}),children:"Add Item"}),(0,p.jsx)(y.A.ErrorList,{errors:o})]})]})}}),(0,p.jsx)(y.A.List,{name:"containers",children:(e,t,a)=>{let{add:l,remove:n}=t,{errors:o}=a;return(0,p.jsxs)(p.Fragment,{children:[e.map((e=>{let{key:t,name:a,...l}=e;return(0,p.jsxs)(v.A,{style:{display:"flex"},align:"baseline",children:[(0,p.jsx)(y.A.Item,{...l,name:[a,"type"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing type"}],children:(0,p.jsx)(s.A,{placeholder:"type",style:{width:"100%"},popupMatchSelectWidth:!1,children:d.vr.map((e=>(0,p.jsx)(s.A.Option,{value:e,children:e},e)))})}),(0,p.jsx)(y.A.Item,{...l,name:[a,"quantity"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing quantity"}],children:(0,p.jsx)(b.A,{placeholder:"Qtn",type:"number",style:{marginBottom:0}})}),(0,p.jsx)(j.F,{size:24,color:"#000",style:{marginBottom:"-7px"},onClick:()=>n(a)})]},t)})),(0,p.jsxs)(y.A.Item,{wrapperCol:{span:24},children:[(0,p.jsx)(f.Ay,{type:"dashed",onClick:()=>l(),block:!0,icon:(0,p.jsx)(C.f,{size:24,color:"#000"}),children:"Add Containers"}),(0,p.jsx)(y.A.ErrorList,{errors:o})]})]})}}),(0,p.jsx)("div",{style:{textAlign:"right"},children:(0,p.jsx)(f.Ay,{type:"primary",htmlType:"submit",children:"Submit"})})]})})};var $=a(5464);const k=(0,$.Ay)(f.Ay)`
  background: ${e=>e.isActive?e.activeBgc||"":e.bgc||""} !important;
  width: ${e=>e.isActive?e.activeW||"":e.w||""};
  display: ${e=>e.d||""};
  height: ${e=>e.h||""};
  font-size: ${e=>e.fs||"16px"};
  font-weight: ${e=>e.fw||"500"};
  font-family: ${e=>e.ff};
  margin: ${e=>e.m||""};
  margin-right: ${e=>e.mr||""};
  padding: ${e=>e.p||""};
  border: ${e=>e.b||"1px solid rgba(217, 217, 217, 1)"} !important;
  border-radius: ${e=>e.br||"45px"};
  color: ${e=>e.isActive?e.activeC||"rgba(255, 255, 255, 1)":e.c||"rgba(48, 48, 48, 1)"} !important;
  margin-bottom: ${e=>e.mb||""};
  margin-top: ${e=>e.mt||""};
  ${e=>e.bottom&&`bottom: ${e.bottom};`}
  &:focus {
    background: ${e=>e.focusbgc||""} !important;
    border: ${e=>e.b||""} !important;
  }
  &:disabled {
    background: grey !important;
    color: #ccc !important;
    cursor: not-allowed !important;
    border: none !important;
  }
`,F=(0,$.Ay)(f.Ay)`
  background: ${e=>e.bgc||"#FFF"} !important;
  width: ${e=>e.w||""};
  display: ${e=>e.d||""};
  height: ${e=>e.h||"46px"};
  font-size: ${e=>e.fs||"16px"};
  font-weight: ${e=>e.fw||"500"};
  font-family: ${e=>e.ff};
  margin: ${e=>e.m||""};
  margin-right: ${e=>e.mr||""};
  padding: ${e=>e.p||""};
  border: ${e=>e.b||""} !important;
  border-radius: ${e=>e.br||"10px"};
  color: ${e=>e.c||"#3465FF"} !important;
  margin-bottom: ${e=>e.mb||""};
  margin-top: ${e=>e.mt||""};
  ${e=>e.bottom&&`bottom: ${e.bottom};`}

  &:hover {
    background: ${e=>e.hoverbgc?e.hoverbgc:e.bgc||""} !important;
    border: ${e=>e.b||"0px"} !important;
    color: ${e=>e.c||"#3465FF"} !important;
  }
  &:focus {
    background: ${e=>e.focusbgc||""} !important;
    border: ${e=>e.b||""} !important;
    color: ${e=>e.c||"#3465FF"} !important;
  }
  &:disabled {
    background: grey !important;
    color: #ccc !important;
    cursor: not-allowed !important;
    border: none !important;
  }
`;var q=a(7015),T=a(5986),M=a(2532),E=a(3543);const L=l.createContext(null),z=e=>{let{title:t,editable:a,children:n,dataIndex:o,record:r,allItems:i,itemNameToIdMap:c,handleSave:u,...m}=e;const[h,x]=(0,l.useState)(!1),g=(0,l.useRef)(null),v=(0,l.useContext)(L);(0,l.useEffect)((()=>{var e;h&&(null===(e=g.current)||void 0===e||e.focus())}),[h]);const f=()=>{x(!h),v.setFieldsValue({[o]:r[o]})},j=async()=>{try{const e=await v.validateFields();switch(f(),o){case"itemId":e.itemDetails={...e.itemDetails,name:c.get(e.itemId)};break;case"quantity":case"rate":const{rate:t,quantity:a}=e;e.itemTotal=(t||r.rate)*(a||r.quantity)||0}u({...r,...e})}catch(e){console.log("Save failed:",e)}},C=()=>{switch(o){case"itemId":return(0,p.jsx)(s.A,{showSearch:!0,ref:g,optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:i,onChange:j,onBlur:j});case"unit":return(0,p.jsx)(s.A,{placeholder:"units",style:{width:"100%"},onChange:j,onBlur:j,children:d.J8.map((e=>(0,p.jsx)(s.A.Option,{value:e,children:e},e)))});case"rate":case"quantity":return(0,p.jsx)(b.A,{ref:g,onPressEnter:j,onBlur:j,type:"number"});default:return(0,p.jsx)(b.A,{ref:g,onPressEnter:j,onBlur:j})}};let A=n;return a&&(A=h?(0,p.jsx)(y.A.Item,{style:{margin:0},name:o,rules:[{required:!0,message:`${t} is required.`}],children:C()}):(0,p.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingInlineEnd:24},onClick:f,children:n})),(0,p.jsx)("td",{...m,children:A})},N=e=>{let{title:t,editable:a,children:n,dataIndex:o,record:r,allAgents:i,itemNameToIdMap:c,handleSave:u,...m}=e;const[h,x]=(0,l.useState)(!1),g=(0,l.useRef)(null),v=(0,l.useContext)(L);(0,l.useEffect)((()=>{var e;h&&(null===(e=g.current)||void 0===e||e.focus())}),[h]);const f=()=>{x(!h),v.setFieldsValue({[o]:r[o]})},j=async()=>{try{const e=await v.validateFields();f(),u({...r,...e})}catch(e){console.log("Save failed:",e)}},C=()=>{switch(o){case"type":return(0,p.jsx)(s.A,{showSearch:!0,ref:g,optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:d.vr.map((e=>({label:e,value:e}))),onChange:j,onBlur:j});case"quantity":return(0,p.jsx)(b.A,{ref:g,onPressEnter:j,onBlur:j,type:"number"});default:return(0,p.jsx)(b.A,{ref:g,onPressEnter:j,onBlur:j})}};let A=n;return a&&(A=h?(0,p.jsx)(y.A.Item,{style:{margin:0},name:o,rules:[{required:!0,message:`${t} is required.`}],children:C()}):(0,p.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingInlineEnd:24},onClick:f,children:n})),(0,p.jsx)("td",{...m,children:A})},D=e=>{let{index:t,...a}=e;const[l]=y.A.useForm();return(0,p.jsx)(y.A,{form:l,component:!1,children:(0,p.jsx)(L.Provider,{value:l,children:(0,p.jsx)("tr",{...a})})})},O=e=>{let{index:t,...a}=e;const[l]=y.A.useForm();return(0,p.jsx)(y.A,{form:l,component:!1,children:(0,p.jsx)(L.Provider,{value:l,children:(0,p.jsx)("tr",{...a})})})},P=e=>{const{open:t,onClose:a,saleOrder:i,allContacts:c,allItems:m,allAgents:h,itemNameToIdMap:y}=e,[v,b]=(0,l.useState)(null),[A,I]=(0,l.useState)(null),[S,$]=(0,l.useState)([]),[F,q]=(0,l.useState)([]),[T,M]=(0,l.useState)(!1),[E,L]=(0,l.useState)(1),[P,B]=(0,l.useState)(null),[Y,R]=(0,l.useState)(),W=()=>{const e={id:S.length,itemId:1,itemTotal:0,quantity:0,rate:0,unit:"kg",itemDetails:{name:"broccoli"}},t=[...S,e];$(t),Math.ceil(t.length/10)>1&&L(Math.ceil(t.length/10))},_=e=>{const t=[...S],a=t.findIndex((t=>e.id===t.id)),l=t[a];t.splice(a,1,{...l,...e}),$(t)},H=()=>{const e={id:F.length,type:"whiteBox",quantity:1},t=[...F,e];q(t)},Q=e=>{const t=[...F],a=t.findIndex((t=>e.id===t.id)),l=t[a];t.splice(a,1,{...l,...e}),q(t)},V=[{title:"type",dataIndex:"type",editable:!0,onCell:e=>({record:e,editable:!0,dataIndex:"type",title:"type",handleSave:Q})},{title:"Qtn",dataIndex:"quantity",editable:!0,onCell:e=>({record:e,editable:!0,dataIndex:"quantity",title:"Qtn",handleSave:Q})},{width:1,render:(e,t,a)=>S.length>=1?(0,p.jsx)(j.F,{size:24,color:"rgb(140,140,140)",onClick:()=>(e=>{const t=F.filter((t=>t.id!==e));q(t)})(t.id)}):null}],G=[...[{title:"Item Name",dataIndex:"itemId",render:e=>(0,p.jsx)(p.Fragment,{children:y.get(e)})},{title:"rate",dataIndex:"rate"},{title:"Qtn",dataIndex:"quantity"},{title:"unit",dataIndex:"unit"}].map((e=>({...e,editable:!0,onCell:t=>({record:t,editable:!0,dataIndex:e.dataIndex,title:e.title,allItems:m,itemNameToIdMap:y,handleSave:_})}))),{width:1,render:(e,t)=>S.length>=1?(0,p.jsx)(j.F,{size:24,color:"rgb(140,140,140)",onClick:()=>(e=>{if(S.length<=1)return void n.Ay.error("At least one item should be present");const t=S.filter((t=>t.id!==e));$(t)})(t.id)}):null}];return(0,l.useEffect)((()=>{const{date:e,items:t,saleType:a,contactId:l,agentId:n,containers:o}=i||{};$(t||[]),q(o||[]),B(w()(e)),R(a),b(l),I(n)}),[i]),(0,p.jsx)(x.A,{title:"Edit Sale",footer:null,loading:T,open:t,onCancel:a,styles:{content:{padding:"10px"}},style:{maxWidth:"fit-content",top:"50px"},width:"fit-content",children:(0,p.jsxs)(u.u1,{gap:"15px",children:[(0,p.jsx)(r.A,{value:P,style:{alignSelf:"end",marginTop:"10px"},onChange:(e,t)=>B(w()(t))}),(0,p.jsx)(s.A,{showSearch:!0,value:v,placeholder:"Select Customers",optionFilterProp:"label",filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:c,style:{width:"100%"},onChange:(e,t)=>b(t)}),(0,p.jsxs)(u.st,{m:"0",children:[(0,p.jsx)(u.D7,{m:"auto 20px auto 0",fs:"14px",ff:"Inter",children:"Sale Type : "}),(0,p.jsx)(g.Ay.Group,{options:[{label:"Local",value:"local"},{label:"InterState",value:"interState"}],value:Y,optionType:"button",onChange:e=>R(e.target.value)})]}),"interState"==Y&&(0,p.jsxs)(u.st,{m:"0",children:[(0,p.jsx)(u.D7,{m:"auto 20px auto 0",fs:"14px",ff:"Inter",children:"Agent : "}),(0,p.jsx)(s.A,{showSearch:!0,value:A,placeholder:"Select Agent",optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:h,onChange:(e,t)=>I(t)})]}),(0,p.jsx)(o.A,{bordered:!0,size:"middle",columns:G,dataSource:S,rowClassName:()=>"editable-row",pagination:{position:["none","bottomCenter"],pageSize:10,onChange:e=>(0,d.jD)(e,L),current:E},components:{body:{row:D,cell:z}},footer:()=>(0,p.jsx)(f.Ay,{type:"dashed",onClick:W,block:!0,icon:(0,p.jsx)(C.f,{size:24,color:"rgb(140,140,140)"}),children:"Add Item"}),style:{width:"100%",marginLeft:0}}),(0,p.jsx)(o.A,{bordered:!0,size:"middle",columns:V,dataSource:F,rowClassName:()=>"editable-row",pagination:!1,components:{body:{row:O,cell:N}},footer:()=>(0,p.jsx)(f.Ay,{type:"dashed",onClick:H,block:!0,icon:(0,p.jsx)(C.f,{size:24,color:"rgb(140,140,140)"}),children:"Add Container"}),style:{width:"100%",marginLeft:0}}),(0,p.jsx)(k,{c:"#fff",w:"80px",h:"42px",type:"primary",onClick:async()=>{if(!i)return void n.Ay.error("Sale order not found");M(!0);const e={};null!==v&&void 0!==v&&v.value&&v.value!=i.contactId&&(e.contactId=v.value),Y!=i.saleType&&(e.saleType=Y),"interState"==Y&&null!==A&&void 0!==A&&A.value&&A.value!=i.agentId?e.agentId=A.value:"local"==Y&&null!=i.agentId&&(e.agentId=null),w()(i.date).isSame(P,"day")||(e.date=P.valueOf());try{await((e,t)=>{const a=`${d.H$}/saleOrder/update-sale-order/${e}`;return(0,d.Em)({url:a,method:"post",data:t,headers:{"Content-Type":"application/json"}})})(i.id,{saleOrder:e,lineItems:S,containers:F}),n.Ay.success("sale order updated successfully")}catch(t){(0,d.ok)(t),a()}finally{M(!1)}},style:{alignSelf:"center"},children:"Save"})]})})};var B=a(5458),Y=a(6399);const R=a(1238);var W=a(3216);const _=()=>{const e=(0,W.Zp)(),[t,a]=(0,l.useState)([]),[c,x]=(0,l.useState)([]),[y,g]=(0,l.useState)(!1),[v,b]=(0,l.useState)(!1),[f,j]=(0,l.useState)(null),[C,A]=(0,l.useState)([]),[I,$]=(0,l.useState)(new Map),[k,L]=(0,l.useState)([]),[z,N]=(0,l.useState)([]),[D,O]=(0,l.useState)([w()(),w()()]),[_,H]=(0,l.useState)(!0),[Q,V]=(0,l.useState)(null),G=[{title:"Name",dataIndex:"contactName",filteredValue:Q&&[Q.value],onFilter:(e,t)=>t.contactId==e},{title:"Status",dataIndex:"status",render:e=>(0,p.jsx)(Y.A,{bordered:!0,color:h[e],children:e.toLowerCase()})},{key:"action",render:(e,t)=>(0,p.jsx)(B.I,{size:18,color:"rgba(0, 0, 0, 0.58)",weight:"fill",onClick:e=>{e.stopPropagation(),j(t),b(!0)}}),width:1}],J=[{title:"Item Name",dataIndex:"itemId",render:e=>(0,p.jsx)(p.Fragment,{children:k.find((t=>t.value==e)).label})},{title:"rate",dataIndex:"rate"},{title:"Qtn",dataIndex:"quantity"},{title:"unit",dataIndex:"unit"}],U=()=>{null!==c&&void 0!==c&&c.length?((e,t,a)=>{const l=e=>w()(e).format("YYYY-MMM-DD"),n=e.reduce(((e,t)=>{const a=l(t.date);return e[a]||(e[a]=[]),e[a].push(t),e}),{}),o=R.utils.book_new();Object.keys(n).forEach((e=>{const t=n[e].flatMap((e=>e.items.map(((t,a)=>({"Contact Name":0===a?e.contactName:"","Sales Order Number":0===a?e.salesOrderNumber:"","Sale Type":0===a?e.saleType:"",Status:0===a?e.status:"","Invoice Status":0===a?e.invoiceStatus:"",Date:0===a?l(e.date):"",Amount:0===a?e.amount:"","Item Name":t.itemDetails.name,Rate:t.rate,Quantity:t.quantity,Unit:t.unit,"Item Total":t.itemTotal}))))),a=R.utils.json_to_sheet(t);R.utils.book_append_sheet(o,a,e)})),R.writeFile(o,`${t}-${a}_sales.xlsx`),console.log("Excel file has been created successfully.")})(c,D[0].format("YYYY/MM/DD"),D[1].format("YYYY/MM/DD")):n.Ay.error("No Sale Order Found!!")},Z=()=>(0,p.jsxs)(u.st,{m:"0",gap:"20px",children:[(0,p.jsx)(F,{h:"36px",onClick:()=>g(!0),icon:(0,p.jsx)(q.F,{size:18,color:"#000"}),children:"Add"}),(0,p.jsx)(T.z,{size:24,color:"#000",style:{alignSelf:"end",margin:"auto"},onClick:U})]}),K=async()=>{try{const t=await(()=>{const e=`${d.H$}/contact/list-all`;return(0,d.Em)({url:e,method:"get",headers:{"Content-Type":"application/json"}})})();if(200==t.status){var e;const a=null===(e=t.data)||void 0===e?void 0:e.map((e=>({value:e.id,label:e.displayName||"-"})));A(a)}}catch(t){(0,d.ok)(t)}},X=async()=>{try{const t=await(()=>{const e=`${d.H$}/item/list-all`;return(0,d.Em)({url:e,method:"get",headers:{"Content-Type":"application/json"}})})();if(200==t.status){var e;const a=new Map,l=null===(e=t.data)||void 0===e?void 0:e.map((e=>(a.has(e.id)||a.set(e.id,e.name),{value:e.id,label:e.name})));L(l),$(a)}}catch(t){(0,d.ok)(t)}},ee=async()=>{try{const t=await(()=>{const e=`${d.H$}/contact/list-all-agent`;return(0,d.Em)({url:e,method:"get",headers:{"Content-Type":"application/json"}})})();if(200==t.status){var e;const a=null===(e=t.data)||void 0===e?void 0:e.map((e=>({value:e.id,label:e.displayName})));N(a)}}catch(t){(0,d.ok)(t)}},te=async()=>{try{const e=await(e=>{const t=`${d.H$}/saleOrder/list-all`;return(0,d.Em)({url:t,method:"post",data:e,headers:{"Content-Type":"application/json"}})})({startDate:D[0].startOf("day").valueOf(),endDate:D[1].endOf("day").valueOf()});200==e.status&&(a(e.data),x(e.data))}catch(e){(0,d.ok)(e)}},ae=e=>{const t=D[0].add(e,"day");O([t,t])},le=e=>(0,p.jsx)(o.A,{bordered:!0,style:{width:"100%",marginLeft:0},size:"middle",pagination:{position:["none","bottomCenter"],pageSize:5},columns:J,dataSource:e.itemData||[]});return(0,l.useEffect)((()=>{H(D[0].isSame(D[1],"day")),te()}),[D]),(0,l.useEffect)((()=>{K(),X(),ee()}),[]),(0,p.jsxs)(u.u1,{ai:"center",minH:"100vh",maxW:"500px",w:"100%",bgc:"#fff",style:{position:"relative"},children:[(0,p.jsx)(m,{title:"Sales",onBack:()=>e(-1),rightContent:(0,p.jsx)(Z,{})}),(0,p.jsxs)(u.u1,{m:"0",w:"100%",p:"20px",gap:"20px",children:[(0,p.jsxs)(u.st,{w:"100%",m:"0",gap:"20px",children:[(0,p.jsx)(M.d,{size:32,color:"#8c8c8c",display:_?"block":"none",onClick:()=>ae(-1)}),(0,p.jsx)(r.A.RangePicker,{value:D,style:{alignSelf:"end",width:"100%"},onChange:(e,t)=>{const a=t.map((e=>w()(e)));O(a)},format:"YYYY/MM/DD",popupClassName:"yolup"}),(0,p.jsx)(E.g,{size:32,color:"#8c8c8c",display:_?"block":"none",onClick:()=>ae(1)})]}),(0,p.jsxs)(u.st,{w:"100%",m:"0",gap:"20px",children:[(0,p.jsx)(s.A,{showSearch:!0,value:Q,placeholder:"customers",optionFilterProp:"label",filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:C,style:{width:"100%"},onChange:(e,t)=>V(t)}),(0,p.jsx)(F,{h:"32px",fs:"14px",onClick:()=>V(null),children:"Reset"})]}),(0,p.jsx)(o.A,{style:{width:"100%"},size:"middle",pagination:{position:["none","bottomCenter"],pageSize:15},columns:G,dataSource:c||[],expandable:{expandIcon:()=>null,expandIconColumnIndex:-1,expandRowByClick:!0,expandedRowRender:e=>{var t;return(0,p.jsxs)(u.jx,{id:"1234",w:"100%",children:[(0,p.jsx)(i.A,{title:"",size:"small",style:{marginBottom:"10px"},column:{xs:1},items:[{key:"1",label:"Agent",children:e.agentName},{key:"2",label:"Containers",children:null===(t=e.containers)||void 0===t?void 0:t.map((e=>(0,p.jsxs)(p.Fragment,{children:[e.type," : ",e.quantity,(0,p.jsx)("br",{})]})))}]}),(0,p.jsx)(le,{itemData:e.items})]})}},rowKey:(e,t)=>t})]}),(0,p.jsx)(S,{open:y,onClose:()=>g(!1),allContacts:C,getAllContacts:K,allItems:k,getAllItems:X,allAgents:z,fetchOrders:te}),(0,p.jsx)(P,{open:v,onClose:()=>b(!1),saleOrder:f,allContacts:C,allItems:k,allAgents:z,itemNameToIdMap:I})]})}}}]);
//# sourceMappingURL=60.2d2a8cc5.chunk.js.map