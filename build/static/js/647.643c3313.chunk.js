"use strict";(self.webpackChunkorder_frontend=self.webpackChunkorder_frontend||[]).push([[647],{3886:(e,t,a)=>{a.d(t,{A:()=>r});var l=a(6825),n=a(7261),o=a(579);const r=e=>{const{title:t,onBack:a,rightContent:r,bgc:s}=e;return(0,o.jsxs)(n.st,{w:"100%",h:"56px",m:"0",p:"10px 20px",bg:s,children:[(0,o.jsxs)(n.st,{m:"auto 0",gap:"10px",children:[(0,o.jsx)(l.Z,{size:24,color:"#fff",onClick:a}),(0,o.jsx)(n.D7,{fs:"18px",lh:"24px",fw:"600",ff:"Inter",c:"#fff",mb:"auto",children:t})]}),r]})}},3779:(e,t,a)=>{a.d(t,{x:()=>l});const l={PENDING:"orange",PACKED:"purple",SENT:"blue",DONE:"green",CANCELLED:"red"}},6647:(e,t,a)=>{a.r(t),a.d(t,{default:()=>V});var l=a(5043),n=a(4434),o=a(2019),r=a(6953),s=a(3530),i=a(3072),d=a(2148),c=a(3886),u=a(7261),p=a(3779),m=a(7764),h=a(9748),x=a(5672),g=a(6603),y=a(6051),v=a(5720),f=a(4015),b=a(4923),j=a(6177),C=a(446),A=a.n(C),w=a(579);const S=A()().valueOf(),I=e=>{const{open:t,onClose:a,allContacts:r,allItems:i,allAgents:c,fetchOrders:p}=e,[C,I]=(0,l.useState)(!1),[k,$]=(0,l.useState)(0),[D]=h.A.useForm(),E=()=>{const e=D.getFieldValue("lineItems");let t=0;for(const a of e){const{quantity:e,rate:l}=a;t+=l&&e?l*e:0}$(t)},F=()=>{D.resetFields(),a()};return(0,w.jsxs)(x.A,{title:"Add Sales",footer:null,loading:C,open:t,onCancel:F,styles:{content:{padding:"10px"}},style:{top:"50px"},children:[(0,w.jsxs)(u.jx,{pos:"absolute",top:"10px",right:"50px",c:"#00000088",style:{fontWeight:"600",fontSize:"16px"},children:["Total : \u20b9 ",(0,d.ob)(k)]}),(0,w.jsxs)(h.A,{form:D,labelCol:{xs:{span:10},sm:{span:8}},wrapperCol:{xs:{span:14},sm:{span:16}},initialValues:{saleType:"local",date:S},layout:"horizontal",size:"middle",style:{maxWidth:600,margin:"20px 0 10px"},onFinish:async e=>{var t;I(!0);const a={saleOrder:{contactId:e.contactId,agentId:e.agentId,saleType:e.saleType},lineItems:null===(t=e.lineItems)||void 0===t?void 0:t.map((e=>({itemId:e.itemId,type:"SALE_ORDER",quantity:e.quantity,unit:e.unit,rate:e.rate,itemTotal:e.quantity*e.rate}))),containers:e.containers};try{await(0,m.l8)(a),o.Ay.success("sale order added successfully"),p(),F()}catch(l){(0,d.ok)(l)}finally{I(!1)}},children:[(0,w.jsx)(h.A.Item,{name:"date",wrapperCol:{span:24},style:{textAlign:"right"},rules:[{required:!0}],getValueProps:e=>({value:e&&A()(Number(e))}),normalize:e=>e&&`${A()(e).valueOf()}`,children:(0,w.jsx)(s.A,{format:"DD/MM/YYYY"})}),(0,w.jsx)(h.A.Item,{name:"contactId",wrapperCol:{span:24},rules:[{required:!0,message:"Please select a customer!"}],children:(0,w.jsx)(n.A,{showSearch:!0,placeholder:"Select Customer",optionFilterProp:"label",filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:r})}),(0,w.jsx)(h.A.Item,{name:"saleType",label:"sale type",rules:[{required:!0,message:"Please pick an item!"}],children:(0,w.jsxs)(g.Ay.Group,{children:[(0,w.jsx)(g.Ay.Button,{value:"local",children:"Local"}),(0,w.jsx)(g.Ay.Button,{value:"interState",children:"InterState"})]})}),(0,w.jsx)(h.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.saleType!==t.saleType,children:e=>{let{getFieldValue:t}=e;return"interState"===t("saleType")?(0,w.jsx)(h.A.Item,{name:"agentId",label:"Agent",children:(0,w.jsx)(n.A,{showSearch:!0,placeholder:"Select Agent",optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:c})}):null}}),(0,w.jsx)(h.A.List,{name:"lineItems",rules:[{validator:async(e,t)=>{if(!t||t.length<1)return Promise.reject(new Error("At least 1 Item"))}}],children:(e,t,a)=>{let{add:l,remove:o}=t,{errors:r}=a;return(0,w.jsxs)(w.Fragment,{children:[e.map((e=>{let{key:t,name:a,...l}=e;return(0,w.jsxs)(y.A,{style:{display:"flex"},align:"baseline",children:[(0,w.jsx)(h.A.Item,{...l,name:[a,"itemId"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing item"}],children:(0,w.jsx)(n.A,{showSearch:!0,placeholder:"items",optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:i,style:{width:"100%",maxWidth:"80px"}})}),(0,w.jsx)(h.A.Item,{...l,name:[a,"quantity"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing quantity"}],children:(0,w.jsx)(v.A,{placeholder:"Qtn",type:"number",style:{marginBottom:0},onChange:E})}),(0,w.jsx)(h.A.Item,{...l,name:[a,"unit"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing unit"}],initialValue:"kg",children:(0,w.jsx)(n.A,{placeholder:"units",style:{width:"100%"},children:d.J8.map((e=>(0,w.jsx)(n.A.Option,{value:e,children:e},e)))})}),(0,w.jsx)(h.A.Item,{...l,name:[a,"rate"],wrapperCol:{span:24},children:(0,w.jsx)(v.A,{placeholder:"Rate",prefix:"\u20b9",type:"number",style:{marginBottom:0},onChange:E})}),(0,w.jsx)(b.F,{size:24,color:"#000",style:{marginBottom:"-7px"},onClick:()=>{o(a),E()}})]},t)})),(0,w.jsxs)(h.A.Item,{wrapperCol:{span:24},children:[(0,w.jsx)(f.Ay,{type:"dashed",onClick:()=>l(),block:!0,icon:(0,w.jsx)(j.f,{size:24,color:"#000"}),children:"Add Item"}),(0,w.jsx)(h.A.ErrorList,{errors:r})]})]})}}),(0,w.jsx)(h.A.List,{name:"containers",children:(e,t,a)=>{let{add:l,remove:o}=t,{errors:r}=a;return(0,w.jsxs)(w.Fragment,{children:[e.map((e=>{let{key:t,name:a,...l}=e;return(0,w.jsxs)(y.A,{style:{display:"flex"},align:"baseline",children:[(0,w.jsx)(h.A.Item,{...l,name:[a,"type"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing type"}],children:(0,w.jsx)(n.A,{placeholder:"type",style:{width:"100%"},popupMatchSelectWidth:!1,children:d.vr.map((e=>(0,w.jsx)(n.A.Option,{value:e,children:e},e)))})}),(0,w.jsx)(h.A.Item,{...l,name:[a,"quantity"],wrapperCol:{span:24},rules:[{required:!0,message:"Missing quantity"}],children:(0,w.jsx)(v.A,{placeholder:"Qtn",type:"number",style:{marginBottom:0}})}),(0,w.jsx)(b.F,{size:24,color:"#000",style:{marginBottom:"-7px"},onClick:()=>o(a)})]},t)})),(0,w.jsxs)(h.A.Item,{wrapperCol:{span:24},children:[(0,w.jsx)(f.Ay,{type:"dashed",onClick:()=>l(),block:!0,icon:(0,w.jsx)(j.f,{size:24,color:"#000"}),children:"Add Containers"}),(0,w.jsx)(h.A.ErrorList,{errors:r})]})]})}}),(0,w.jsx)("div",{style:{textAlign:"right"},children:(0,w.jsx)(f.Ay,{type:"primary",htmlType:"submit",children:"Submit"})})]})]})};var k=a(2249),$=a(7015),D=a(5986),E=a(2532),F=a(3543),T=a(8876);const M=l.createContext(null),N=e=>{let{title:t,editable:a,children:o,dataIndex:r,record:s,allItems:i,itemNameToIdMap:c,handleSave:u,...p}=e;const[m,x]=(0,l.useState)(!1),g=(0,l.useRef)(null),y=(0,l.useContext)(M);(0,l.useEffect)((()=>{var e;m&&(null===(e=g.current)||void 0===e||e.focus())}),[m]);const f=()=>{x(!m),y.setFieldsValue({[r]:s[r]})},b=async()=>{try{const e=await y.validateFields();switch(f(),r){case"itemId":e.itemDetails={...e.itemDetails,name:c.get(e.itemId)};break;case"quantity":case"rate":const{rate:t,quantity:a}=e;e.itemTotal=(t||s.rate)*(a||s.quantity)||0}u({...s,...e})}catch(e){console.log("Save failed:",e)}},j=()=>{switch(r){case"itemId":return(0,w.jsx)(n.A,{showSearch:!0,ref:g,optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:i,onChange:b,onBlur:b});case"unit":return(0,w.jsx)(n.A,{placeholder:"units",style:{width:"100%"},onChange:b,onBlur:b,children:d.J8.map((e=>(0,w.jsx)(n.A.Option,{value:e,children:e},e)))});case"rate":case"quantity":return(0,w.jsx)(v.A,{ref:g,onPressEnter:b,onBlur:b,type:"number"});default:return(0,w.jsx)(v.A,{ref:g,onPressEnter:b,onBlur:b})}};let C=o;return a&&(C=m?(0,w.jsx)(h.A.Item,{style:{margin:0},name:r,rules:[{required:!0,message:`${t} is required.`}],children:j()}):(0,w.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingInlineEnd:24},onClick:f,children:o})),(0,w.jsx)("td",{...p,children:C})},L=e=>{let{title:t,editable:a,children:o,dataIndex:r,record:s,allAgents:i,itemNameToIdMap:c,handleSave:u,...p}=e;const[m,x]=(0,l.useState)(!1),g=(0,l.useRef)(null),y=(0,l.useContext)(M);(0,l.useEffect)((()=>{var e;m&&(null===(e=g.current)||void 0===e||e.focus())}),[m]);const f=()=>{x(!m),y.setFieldsValue({[r]:s[r]})},b=async()=>{try{const e=await y.validateFields();f(),u({...s,...e})}catch(e){console.log("Save failed:",e)}},j=()=>{switch(r){case"type":return(0,w.jsx)(n.A,{showSearch:!0,ref:g,optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:d.vr.map((e=>({label:e,value:e}))),onChange:b,onBlur:b});case"quantity":return(0,w.jsx)(v.A,{ref:g,onPressEnter:b,onBlur:b,type:"number"});default:return(0,w.jsx)(v.A,{ref:g,onPressEnter:b,onBlur:b})}};let C=o;return a&&(C=m?(0,w.jsx)(h.A.Item,{style:{margin:0},name:r,rules:[{required:!0,message:`${t} is required.`}],children:j()}):(0,w.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingInlineEnd:24},onClick:f,children:o})),(0,w.jsx)("td",{...p,children:C})},O=e=>{let{index:t,...a}=e;const[l]=h.A.useForm();return(0,w.jsx)(h.A,{form:l,component:!1,children:(0,w.jsx)(M.Provider,{value:l,children:(0,w.jsx)("tr",{...a})})})},q=e=>{let{index:t,...a}=e;const[l]=h.A.useForm();return(0,w.jsx)(h.A,{form:l,component:!1,children:(0,w.jsx)(M.Provider,{value:l,children:(0,w.jsx)("tr",{...a})})})},P=e=>{const{open:t,onClose:a,saleOrder:i,allContacts:c,allItems:p,allAgents:h,itemNameToIdMap:y}=e,[v,C]=(0,l.useState)(null),[S,I]=(0,l.useState)(null),[$,D]=(0,l.useState)([]),[E,F]=(0,l.useState)([]),[T,M]=(0,l.useState)(!1),[P,Y]=(0,l.useState)(1),[z,B]=(0,l.useState)(null),[R,W]=(0,l.useState)(),_=()=>{const e={id:$.length,itemId:1,itemTotal:0,quantity:"",rate:"",unit:"kg",itemDetails:{name:"broccoli"}},t=[...$,e];D(t),Math.ceil(t.length/10)>1&&Y(Math.ceil(t.length/10))},V=e=>{const t=[...$],a=t.findIndex((t=>e.id===t.id)),l=t[a];t.splice(a,1,{...l,...e}),D(t)},H=()=>{const e={id:E.length,type:"whiteBox",quantity:1},t=[...E,e];F(t)},Q=e=>{const t=[...E],a=t.findIndex((t=>e.id===t.id)),l=t[a];t.splice(a,1,{...l,...e}),F(t)},G=[{title:"type",dataIndex:"type",editable:!0,onCell:e=>({record:e,editable:!0,dataIndex:"type",title:"type",handleSave:Q})},{title:"Qtn",dataIndex:"quantity",editable:!0,onCell:e=>({record:e,editable:!0,dataIndex:"quantity",title:"Qtn",handleSave:Q})},{width:1,render:(e,t,a)=>$.length>=1?(0,w.jsx)(b.F,{size:24,color:"rgb(140,140,140)",onClick:()=>(e=>{const t=E.filter((t=>t.id!==e));F(t)})(t.id)}):null}],K=[...[{title:"Item Name",dataIndex:"itemId",render:e=>(0,w.jsx)(w.Fragment,{children:y.get(e)})},{title:"Qtn",dataIndex:"quantity"},{title:"unit",dataIndex:"unit"},{title:"rate",dataIndex:"rate"}].map((e=>({...e,editable:!0,onCell:t=>({record:t,editable:!0,dataIndex:e.dataIndex,title:e.title,allItems:p,itemNameToIdMap:y,handleSave:V})}))),{width:1,render:(e,t)=>$.length>=1?(0,w.jsx)(b.F,{size:24,color:"rgb(140,140,140)",onClick:()=>(e=>{if($.length<=1)return void o.Ay.error("At least one item should be present");const t=$.filter((t=>t.id!==e));D(t)})(t.id)}):null}];return(0,l.useEffect)((()=>{const{date:e,items:t,saleType:a,contactId:l,agentId:n,containers:o}=i||{};D(t||[]),F(o||[]),B(A()(e)),W(a),C(l),I(n)}),[i]),(0,w.jsx)(x.A,{title:"Edit Sale",footer:null,loading:T,open:t,onCancel:a,styles:{content:{padding:"10px"}},style:{maxWidth:"fit-content",top:"50px"},width:"fit-content",children:(0,w.jsxs)(u.u1,{gap:"15px",children:[(0,w.jsx)(s.A,{value:z,style:{alignSelf:"end",marginTop:"10px"},format:"DD/MM/YYYY",onChange:(e,t)=>B(A()(t,"DD/MM/YYYY"))}),(0,w.jsx)(n.A,{showSearch:!0,value:v,placeholder:"Select Customers",optionFilterProp:"label",filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:c,style:{width:"100%"},onChange:(e,t)=>C(t)}),(0,w.jsxs)(u.st,{m:"0",children:[(0,w.jsx)(u.D7,{m:"auto 20px auto 0",fs:"14px",ff:"Inter",children:"Sale Type : "}),(0,w.jsx)(g.Ay.Group,{options:[{label:"Local",value:"local"},{label:"InterState",value:"interState"}],value:R,optionType:"button",onChange:e=>W(e.target.value)})]}),"interState"==R&&(0,w.jsxs)(u.st,{m:"0",children:[(0,w.jsx)(u.D7,{m:"auto 20px auto 0",fs:"14px",ff:"Inter",children:"Agent : "}),(0,w.jsx)(n.A,{showSearch:!0,value:S,placeholder:"Select Agent",optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:h,onChange:(e,t)=>I(t)})]}),(0,w.jsx)(r.A,{bordered:!0,size:"middle",columns:K,dataSource:$,rowClassName:()=>"editable-row",pagination:{position:["none","bottomCenter"],pageSize:10,onChange:e=>(0,d.jD)(e,Y),current:P},components:{body:{row:O,cell:N}},footer:()=>(0,w.jsx)(f.Ay,{type:"dashed",onClick:_,block:!0,icon:(0,w.jsx)(j.f,{size:24,color:"rgb(140,140,140)"}),children:"Add Item"}),style:{width:"100%",marginLeft:0}}),(0,w.jsx)(r.A,{bordered:!0,size:"middle",columns:G,dataSource:E,rowClassName:()=>"editable-row",pagination:!1,components:{body:{row:q,cell:L}},footer:()=>(0,w.jsx)(f.Ay,{type:"dashed",onClick:H,block:!0,icon:(0,w.jsx)(j.f,{size:24,color:"rgb(140,140,140)"}),children:"Add Container"}),style:{width:"100%",marginLeft:0}}),(0,w.jsx)(k.v,{c:"#fff",w:"80px",h:"42px",type:"primary",onClick:async()=>{if(!i)return void o.Ay.error("Sale order not found");M(!0);const e={};null!==v&&void 0!==v&&v.value&&v.value!=i.contactId&&(e.contactId=v.value),R!=i.saleType&&(e.saleType=R),"interState"==R&&null!==S&&void 0!==S&&S.value&&S.value!=i.agentId?e.agentId=S.value:"local"==R&&null!=i.agentId&&(e.agentId=null),A()(i.date).isSame(z,"day")||(e.date=z.valueOf());try{await(0,m.nP)(i.id,{saleOrder:e,lineItems:$,containers:E}),o.Ay.success("sale order updated successfully")}catch(t){(0,d.ok)(t),a()}finally{M(!1)}},style:{alignSelf:"center"},children:"Save"})]})})};var Y=a(5458),z=a(6399);const B=a(1238);var R=a(5543),W=a(3216);const _=[{value:"PENDING",label:(0,w.jsx)(u.D7,{ta:"left",fs:"14px",fw:"600",c:p.x.PENDING,children:"Pending"})},{value:"PACKED",label:(0,w.jsx)(u.D7,{ta:"left",fs:"14px",fw:"600",c:p.x.PACKED,children:"Packed"})},{value:"SENT",label:(0,w.jsx)(u.D7,{ta:"left",fs:"14px",fw:"600",c:p.x.SENT,children:"Sent"})},{value:"DONE",label:(0,w.jsx)(u.D7,{ta:"left",fs:"14px",fw:"600",c:p.x.DONE,children:"Done"})},{value:"CANCELLED",label:(0,w.jsx)(u.D7,{ta:"left",fs:"14px",fw:"600",c:p.x.CANCELLED,children:"Cancelled"})}],V=()=>{const e=(0,W.Zp)(),[t,a]=(0,l.useState)([]),[h,x]=(0,l.useState)([]),[g,y]=(0,l.useState)(!1),[v,f]=(0,l.useState)(!1),[b,j]=(0,l.useState)(null),[C,S]=(0,l.useState)([]),[M,N]=(0,l.useState)(new Map),[L,O]=(0,l.useState)([]),[q,V]=(0,l.useState)([]),[H,Q]=(0,l.useState)([A()(),A()()]),[G,K]=(0,l.useState)(!0),[U,J]=(0,l.useState)(null),[Z,X]=(0,l.useState)(null),ee=window.localStorage.getItem("role"),te=ee&&["admin","accountant"].includes(ee),ae=[{title:"Name",dataIndex:"contactName",filteredValue:U&&[U],onFilter:(e,t)=>t.contactId==e}];(0,d.x8)("EDIT_SALE_ORDER")?ae.push({title:"Status",dataIndex:"status",filteredValue:Z&&[Z],onFilter:(e,t)=>t.status==e,render:(e,t)=>(0,w.jsx)(n.A,{value:e,options:_,style:{width:"fit-content"},popupMatchSelectWidth:!1,onClick:e=>e.stopPropagation(),onChange:a=>(async(e,t,a)=>{try{const t=h.map((t=>t.id===e?{...t,status:a}:t));x(t),await(0,m.mr)(e,{status:a})}catch(l){(0,d.ok)(l);const a=h.map((a=>a.id===e?{...a,status:t}:a));x(a)}})(t.id,e,a)})},{key:"action",render:(e,t)=>(0,w.jsx)(Y.I,{size:18,color:"rgba(0, 0, 0, 0.58)",weight:"fill",onClick:e=>{e.stopPropagation(),(0,d.ro)(new Date(t.date),new Date)||te?(j(t),f(!0)):o.Ay.error("You don't have permission")}}),width:1}):ae.push({title:"Status",dataIndex:"status",render:e=>(0,w.jsx)(z.A,{color:p.x[e],children:e.toLowerCase()})});const le=[{title:"Item Name",dataIndex:"itemId",render:e=>(0,w.jsx)(w.Fragment,{children:L.find((t=>t.value==e)).label})},{title:"Qtn",dataIndex:"quantity"},{title:"unit",dataIndex:"unit"},{title:"rate",dataIndex:"rate"}],ne=()=>{null!==h&&void 0!==h&&h.length?((e,t,a)=>{const l=e=>A()(e).format("DD-MM-YYYY"),n=e.reduce(((e,t)=>{const a=l(t.date);return e[a]||(e[a]=[]),e[a].push(t),e}),{}),o=B.utils.book_new();Object.keys(n).forEach((e=>{const t=n[e].flatMap((e=>e.items.map(((t,a)=>({"Contact Name":0===a?e.contactName:"","Sales Order Number":0===a?e.salesOrderNumber:"","Sale Type":0===a?e.saleType:"",Status:0===a?e.status:"","Invoice Status":0===a?e.invoiceStatus:"",Date:0===a?l(e.date):"",Amount:0===a?e.amount:"","Item Name":t.itemDetails.name,Rate:t.rate,Quantity:t.quantity,Unit:t.unit,"Item Total":t.itemTotal}))))),a=B.utils.json_to_sheet(t);B.utils.book_append_sheet(o,a,e)})),B.writeFile(o,`${t}-${a}_sales.xlsx`),console.log("Excel file has been created successfully.")})(h,H[0].format("DD/MM/YYYY"),H[1].format("DD/MM/YYYY")):o.Ay.error("No Sale Order Found!!")},oe=()=>(0,w.jsxs)(u.st,{m:"0",gap:"20px",children:[(0,w.jsx)(k.O,{h:"32px",shape:"circle",icon:(0,w.jsx)($.F,{size:18,color:"#6a8099",weight:"bold"}),onClick:()=>y(!0),style:{margin:"auto"}}),(0,w.jsx)(D.z,{size:24,color:"#fff",style:{alignSelf:"end",margin:"auto"},onClick:ne})]}),re=async()=>{try{const t=await(0,m.b6)();if(200==t.status){var e;const a=null===(e=t.data)||void 0===e?void 0:e.map((e=>({value:e.id,label:e.displayName||"-"})));S(a)}}catch(t){(0,d.ok)(t)}},se=async()=>{try{const t=await(0,m.cg)();if(200==t.status){var e;const a=new Map,l=null===(e=t.data)||void 0===e?void 0:e.map((e=>(a.has(e.id)||a.set(e.id,e.name),{value:e.id,label:e.name})));O(l),N(a)}}catch(t){(0,d.ok)(t)}},ie=async()=>{try{const e=await(0,m.B9)({startDate:H[0].startOf("day").valueOf(),endDate:H[1].endOf("day").valueOf()});200==e.status&&(a(e.data),x(e.data))}catch(e){(0,d.ok)(e)}},de=e=>{const t=H[0].add(e,"day");Q([t,t])},ce=e=>(0,w.jsx)(r.A,{bordered:!0,style:{width:"100%",marginLeft:0},size:"middle",pagination:{position:["none","bottomCenter"],pageSize:5},columns:le,dataSource:e.itemData||[]});return(0,l.useEffect)((()=>{K(H[0].isSame(H[1],"day")),ie()}),[H]),(0,l.useEffect)((()=>{re(),se(),(async()=>{try{const t=await(0,R.S)();if(200==t.status){var e;const a=null===(e=t.data)||void 0===e?void 0:e.map((e=>({value:e.id,label:e.displayName})));V(a)}}catch(t){(0,d.ok)(t)}})()}),[]),(0,w.jsxs)(u.u1,{ai:"center",minH:"100vh",maxW:"500px",w:"100%",bgc:"#fff",style:{position:"relative"},children:[(0,w.jsx)(c.A,{title:"Sales",bgc:"seagreen",onBack:()=>e(-1),rightContent:(0,d.x8)("EDIT_SALE_ORDER")?(0,w.jsx)(oe,{}):null}),(0,w.jsxs)(u.u1,{m:"0",w:"100%",p:"20px",gap:"20px",children:[(0,d.x8)("EDIT_SALE_ORDER")&&(0,w.jsxs)(u.st,{w:"100%",m:"0",gap:"20px",children:[(0,w.jsx)(E.d,{size:32,color:"#8c8c8c",display:G?"block":"none",onClick:()=>de(-1)}),(0,w.jsx)(s.A.RangePicker,{value:H,style:{alignSelf:"end",width:"100%"},onChange:(e,t)=>{const a=t.map((e=>A()(e,"DD/MM/YYYY")));Q(a)},format:"DD/MM/YYYY",popupClassName:"yolup"}),(0,w.jsx)(F.g,{size:32,color:"#8c8c8c",display:G?"block":"none",onClick:()=>de(1)})]}),(0,w.jsxs)(u.st,{w:"100%",m:"0",gap:"20px",children:[(0,w.jsx)(n.A,{showSearch:!0,value:U,placeholder:"customers",optionFilterProp:"label",popupMatchSelectWidth:!1,filterSort:(e,t)=>{var a,l;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase())},options:C,style:{minWidth:"40%",width:"100%"},onChange:e=>J(e)}),(0,w.jsx)(n.A,{value:Z,options:_,placeholder:"status",style:{width:"fit-content"},popupMatchSelectWidth:!1,onChange:e=>X(e)}),(0,w.jsx)(T.P,{size:32,weight:"bold",color:"#00000070",onClick:()=>{J(null),X(null)}})]}),(0,w.jsx)(r.A,{style:{width:"100%"},size:"middle",pagination:{position:["none","bottomCenter"],pageSize:15},columns:ae,dataSource:h||[],expandable:{expandIcon:()=>null,expandIconColumnIndex:-1,expandRowByClick:!0,expandedRowRender:e=>{var t;return(0,w.jsxs)(u.jx,{id:"1234",w:"100%",children:[(0,w.jsx)(ce,{itemData:e.items}),(0,w.jsx)(i.A,{title:"",size:"small",style:{marginBottom:"10px"},layout:"vertical",bordered:!0,column:{xs:2},items:[{key:"1",label:"Agent",children:e.agentName},{key:"2",label:"Containers",children:null===(t=e.containers)||void 0===t?void 0:t.map((e=>(0,w.jsxs)(w.Fragment,{children:[e.type," : ",e.quantity,(0,w.jsx)("br",{})]})))},{key:"3",label:"Total",children:`\u20b9 ${(0,d.ob)(e.items.reduce(((e,t)=>e+(t.itemTotal||0)),0))}`},{key:"4",label:"Invoice Pdf",children:(0,w.jsx)("span",{style:{color:"blue",textDecoration:"underline"},onClick:()=>(async e=>{try{const t=await(0,m.OA)({saleOrderId:e});if(200===t.status){const e=document.createElement("a");e.href=t.data.signedUrl,e.download="invoice.pdf",e.click()}}catch(t){(0,d.ok)(t)}})(e.id),children:"Download"})}]})]})}},rowKey:(e,t)=>t})]}),(0,w.jsx)(I,{open:g,onClose:()=>y(!1),allContacts:C,getAllContacts:re,allItems:L,getAllItems:se,allAgents:q,fetchOrders:ie}),(0,w.jsx)(P,{open:v,onClose:()=>f(!1),saleOrder:b,allContacts:C,allItems:L,allAgents:q,itemNameToIdMap:M})]})}},2249:(e,t,a)=>{a.d(t,{O:()=>r,v:()=>o});var l=a(4015),n=a(5464);const o=(0,n.Ay)(l.Ay)`
  background: ${e=>e.isActive?e.activeBgc||"":e.bgc||""} !important;
  width: ${e=>e.isActive?e.activeW||"":e.w||""};
  display: ${e=>e.d||""};
  height: ${e=>e.h||""};
  font-size: ${e=>e.fs||"16px"};
  font-weight: ${e=>e.fw||"500"};
  font-family: ${e=>e.ff};
  margin: ${e=>e.m||""};
  margin-right: ${e=>e.mr||""};
  padding: ${e=>e.p||""};
  border: ${e=>e.b||"1px solid rgba(217, 217, 217, 1)"} !important;
  border-radius: ${e=>e.br||"45px"};
  color: ${e=>e.isActive?e.activeC||"rgba(255, 255, 255, 1)":e.c||"rgba(48, 48, 48, 1)"} !important;
  margin-bottom: ${e=>e.mb||""};
  margin-top: ${e=>e.mt||""};
  ${e=>e.bottom&&`bottom: ${e.bottom};`}
  &:focus {
    background: ${e=>e.focusbgc||""} !important;
    border: ${e=>e.b||""} !important;
  }
  &:disabled {
    background: grey !important;
    color: #ccc !important;
    cursor: not-allowed !important;
    border: none !important;
  }
`,r=(0,n.Ay)(l.Ay)`
  background: ${e=>e.bgc||"#FFF"} !important;
  width: ${e=>e.w||""};
  display: ${e=>e.d||""};
  height: ${e=>e.h||"46px"};
  font-size: ${e=>e.fs||"16px"};
  font-weight: ${e=>e.fw||"500"};
  font-family: ${e=>e.ff};
  margin: ${e=>e.m||""};
  margin-right: ${e=>e.mr||""};
  padding: ${e=>e.p||""};
  border: ${e=>e.b||""} !important;
  border-radius: ${e=>e.br||"10px"};
  color: ${e=>e.c||"#3465FF"} !important;
  margin-bottom: ${e=>e.mb||""};
  margin-top: ${e=>e.mt||""};
  ${e=>e.bottom&&`bottom: ${e.bottom};`}

  &:hover {
    background: ${e=>e.hoverbgc?e.hoverbgc:e.bgc||""} !important;
    border: ${e=>e.b||"0px"} !important;
    color: ${e=>e.c||"#3465FF"} !important;
  }
  &:focus {
    background: ${e=>e.focusbgc||""} !important;
    border: ${e=>e.b||""} !important;
    color: ${e=>e.c||"#3465FF"} !important;
  }
  &:disabled {
    background: grey !important;
    color: #ccc !important;
    cursor: not-allowed !important;
    border: none !important;
  }
`},7764:(e,t,a)=>{a.d(t,{B9:()=>n,OA:()=>c,b6:()=>o,cg:()=>r,l8:()=>s,mr:()=>d,nP:()=>i});var l=a(2148);const n=e=>{const t=`${l.H$}/saleOrder/list-all`;return(0,l.Em)({url:t,method:"post",data:e,headers:{"Content-Type":"application/json"}})},o=()=>{const e=`${l.H$}/contact/list-all`;return(0,l.Em)({url:e,method:"get",headers:{"Content-Type":"application/json"}})},r=()=>{const e=`${l.H$}/item/list-all`;return(0,l.Em)({url:e,method:"get",headers:{"Content-Type":"application/json"}})},s=e=>{const t=`${l.H$}/saleOrder/add-sale-order`;return(0,l.Em)({url:t,method:"post",data:e,headers:{"Content-Type":"application/json"}})},i=(e,t)=>{const a=`${l.H$}/saleOrder/update-sale-order/${e}`;return(0,l.Em)({url:a,method:"post",data:t,headers:{"Content-Type":"application/json"}})},d=(e,t)=>{const a=`${l.H$}/saleOrder/update-sale-order-status/${e}`;return(0,l.Em)({url:a,method:"post",data:t,headers:{"Content-Type":"application/json"}})},c=e=>{const t=`${l.H$}/invoice/get-invoice-pdf`;return(0,l.Em)({url:t,method:"post",data:e,headers:{"Content-Type":"application/json"}})}}}]);
//# sourceMappingURL=647.643c3313.chunk.js.map